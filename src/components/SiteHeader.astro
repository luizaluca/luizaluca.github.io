---
import { site } from '../data/site';
---

<header class="relative" data-menu-root>
  <nav aria-label="Top" class="fixed z-10 w-full">
    <div class="bg-gray-100">
      <div
        class="mx-auto flex h-10 max-w-7xl items-center justify-between gap-4 px-4 sm:px-6 lg:space-x-6 lg:px-8"
      >
        <a
          href={`tel://${site.phoneNumber}`}
          class="flex flex-1 items-center justify-center whitespace-nowrap rounded-full border border-transparent px-3 py-1.5 text-sm font-medium uppercase text-gray-600 transition hover:bg-medicenter_color hover:text-white lg:flex-none"
        >
          <span class="mr-1">☎</span>{site.displayNumber}
        </a>
        <a
          class="hidden items-center justify-center gap-2 whitespace-nowrap rounded-full border border-transparent px-3 py-1.5 text-sm font-medium uppercase text-gray-600 transition hover:bg-medicenter_color hover:text-white sm:inline-flex"
          href="/"
        >
          Dr. Elena Luiza Luca
        </a>
        <div class="hidden flex-1 items-center justify-end space-x-6 lg:flex">
          <a
            href="/galeria-zambetelor/"
            class="hidden items-center justify-center gap-2 whitespace-nowrap rounded-full border border-transparent px-3 py-1.5 text-sm font-medium uppercase text-gray-600 transition hover:bg-medicenter_color hover:text-white sm:inline-flex"
            >Galeria zâmbetelor</a
          >
          <a
            href="/carte/"
            class="hidden items-center justify-center gap-2 whitespace-nowrap rounded-full border border-transparent px-3 py-1.5 text-sm font-medium uppercase text-gray-600 transition hover:bg-medicenter_color hover:text-white sm:inline-flex"
            >Carte</a
          >
          <a
            href={site.instagram}
            class="hidden items-center justify-center gap-2 whitespace-nowrap rounded-full border border-transparent px-3 py-1.5 text-sm font-medium uppercase text-gray-600 transition hover:bg-medicenter_color hover:text-white sm:inline-flex"
            >Instagram</a
          >
        </div>
        <div class="mobile-menu-toggle flex items-center lg:hidden">
          <button
            type="button"
            class="rounded-md p-2 text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-medicenter_color"
            data-open-menu
            aria-expanded="false"
            aria-controls="mobile-menu"
          >
            <span class="sr-only">Deschide meniul</span>
            <svg
              class="h-6 w-6"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
              ><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"
              ></path></svg
            >
          </button>
        </div>
      </div>
    </div>
  </nav>

  <div
    id="mobile-menu"
    class="fixed inset-x-0 top-10 bottom-0 z-50 hidden p-2 transition lg:hidden sm:p-4"
    data-mobile-menu
  >
    <button
      type="button"
      class="absolute inset-0 bg-black/25 backdrop-blur-[1px]"
      aria-label="Închide meniul"
      data-close-menu
    ></button>
    <div
      class="relative mx-auto w-full max-w-md divide-y-2 divide-gray-50 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5"
    >
      <div class="px-5 pb-6 pt-5">
        <div class="flex items-start justify-between">
          <nav class="space-y-4">
            <a
              href="/"
              data-mobile-nav-link
              class="block text-base font-medium text-gray-900 hover:text-medicenter_color"
              >Dr. Elena Luiza Luca</a
            >
            <a
              href="/galeria-zambetelor/"
              data-mobile-nav-link
              class="block text-base font-medium text-gray-900 hover:text-medicenter_color"
              >Galeria zâmbetelor</a
            >
            <a
              href="/carte/"
              data-mobile-nav-link
              class="block text-base font-medium text-gray-900 hover:text-medicenter_color"
              >Carte</a
            >
            <a
              href={site.instagram}
              data-mobile-nav-link
              class="block text-base font-medium text-gray-900 hover:text-medicenter_color"
              >Instagram</a
            >
            <a
              href={`tel://${site.phoneNumber}`}
              data-mobile-nav-link
              class="block text-base font-medium text-gray-900 hover:text-medicenter_color"
              >Sună: {site.displayNumber}</a
            >
          </nav>
          <button
            type="button"
            class="-mr-2 inline-flex items-center justify-center rounded-md bg-white p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"
            data-close-menu
          >
            <span class="sr-only">Close menu</span>
            <svg
              class="h-6 w-6"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path></svg
            >
          </button>
        </div>
      </div>
    </div>
  </div>
</header>

<script is:inline>
  const root = document.querySelector('[data-menu-root]');
  const menu = document.querySelector('[data-mobile-menu]');
  const openBtn = document.querySelector('[data-open-menu]');
  const closeBtns = Array.from(document.querySelectorAll('[data-close-menu]'));
  const mobileNavLinks = Array.from(document.querySelectorAll('[data-mobile-nav-link]'));

  const closeMenu = () => {
    if (!menu || !openBtn) return;
    menu.classList.add('hidden');
    openBtn.setAttribute('aria-expanded', 'false');
    document.body.classList.remove('overflow-hidden');
  };

  openBtn?.addEventListener('click', () => {
    if (!menu) return;
    menu.classList.remove('hidden');
    openBtn.setAttribute('aria-expanded', 'true');
    document.body.classList.add('overflow-hidden');
  });

  closeBtns.forEach((btn) => btn.addEventListener('click', closeMenu));
  mobileNavLinks.forEach((link) => link.addEventListener('click', closeMenu));

  document.addEventListener('click', (event) => {
    if (!menu || menu.classList.contains('hidden')) return;
    const target = event.target;
    if (!(target instanceof Node)) return;
    if (!menu.contains(target) && !root?.contains(target)) {
      closeMenu();
    }
  });

  document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') closeMenu();
  });

  window.addEventListener('resize', () => {
    if (window.innerWidth >= 1024) closeMenu();
  });
</script>
